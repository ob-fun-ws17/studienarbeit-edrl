<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-comment">-- | Das Modul Interpreter stellt Funktionen zur Verf&#252;gung , welche Zust&#228;nde und Events interpretieren</span><span>
</span><a name="line-2"></a><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Interpreter</span><span>
</span><a name="line-3"></a><span>    </span><span class="hs-special">(</span><span>
</span><a name="line-4"></a><span>    </span><a href="Interpreter.html#process"><span class="hs-identifier hs-var">process</span></a><span class="hs-special">,</span><span>
</span><a name="line-5"></a><span>    </span><a href="Interpreter.html#update"><span class="hs-identifier hs-var">update</span></a><span class="hs-special">,</span><span>
</span><a name="line-6"></a><span>    </span><a href="Interpreter.html#update%27"><span class="hs-identifier hs-var">update'</span></a><span>
</span><a name="line-7"></a><span>    </span><span class="hs-special">)</span><span>
</span><a name="line-8"></a><span class="hs-keyword">where</span><span>
</span><a name="line-9"></a><span class="hs-keyword">import</span><span> </span><a href="DataDefinitions.html"><span class="hs-identifier">DataDefinitions</span></a><span>
</span><a name="line-10"></a><span class="hs-keyword">import</span><span> </span><a href="YMLReader.html"><span class="hs-identifier">YMLReader</span></a><span>
</span><a name="line-11"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Data</span><span class="hs-operator">.</span><span class="hs-identifier">Set</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Set</span><span class="hs-special">)</span><span>
</span><a name="line-12"></a><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-identifier">Data</span><span class="hs-operator">.</span><span class="hs-identifier">Set</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="hs-identifier">Set</span><span>
</span><a name="line-13"></a><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-identifier">Data</span><span class="hs-operator">.</span><span class="hs-identifier">Maybe</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="hs-identifier">Maybe</span><span>
</span><a name="line-14"></a><span class="hs-keyword">import</span><span> </span><span class="hs-identifier">Data</span><span class="hs-operator">.</span><span class="hs-identifier">Map</span><span class="hs-operator">.</span><span class="hs-identifier">Strict</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-type">Map</span><span class="hs-special">)</span><span>
</span><a name="line-15"></a><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-identifier">Data</span><span class="hs-operator">.</span><span class="hs-identifier">Map</span><span class="hs-operator">.</span><span class="hs-identifier">Strict</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="hs-identifier">Map</span><span>
</span><a name="line-16"></a><span>
</span><a name="line-17"></a><span class="hs-comment">-- | update arbeitet ein Event in den Zustand ein und lieferten diesen Neuen Zustand zur&#252;ck.</span><span>
</span><a name="line-18"></a><span class="hs-comment">-- folgende 'Event' sind m&#246;glich:</span><span>
</span><a name="line-19"></a><span class="hs-comment">-- 'Add_Relation'</span><span>
</span><a name="line-20"></a><span class="hs-comment">-- 'Start_Execution'</span><span>
</span><a name="line-21"></a><span class="hs-comment">-- 'Trigger_Event'</span><span>
</span><a name="line-22"></a><span class="hs-comment">-- die Funktion geht davon aus, dass das aufgerufene Event in diesem Zustand m&#246;glich ist.</span><span>
</span><a name="line-23"></a><span class="hs-identifier">update</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="DataDefinitions.html#State"><span class="hs-identifier hs-type">State</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="DataDefinitions.html#Event"><span class="hs-identifier hs-type">Event</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="DataDefinitions.html#State"><span class="hs-identifier hs-type">State</span></a><span>
</span><a name="line-24"></a><a name="update"><a href="Interpreter.html#update"><span class="hs-identifier">update</span></a></a><span> </span><a name="local-6989586621679077080"><a href="#local-6989586621679077080"><span class="hs-identifier">s</span></a></a><span> </span><span class="hs-special">(</span><a href="DataDefinitions.html#Add_Relation"><span class="hs-identifier hs-var">Add_Relation</span></a><span> </span><a name="local-6989586621679077081"><a href="#local-6989586621679077081"><span class="hs-identifier">rel</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679077080"><span class="hs-identifier hs-var">s</span></a><span> </span><span class="hs-special">{</span><span>
</span><a name="line-25"></a><span>  </span><span class="hs-identifier">missing</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Set</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">union</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">missing</span><span> </span><a href="#local-6989586621679077080"><span class="hs-identifier hs-var">s</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">Set</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">fromList</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier">input</span><span> </span><a href="#local-6989586621679077081"><span class="hs-identifier hs-var">rel</span></a><span>
</span><a name="line-26"></a><span>  </span><span class="hs-special">,</span><span class="hs-identifier">available</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Set</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">insert</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">output</span><span> </span><a href="#local-6989586621679077081"><span class="hs-identifier hs-var">rel</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">available</span><span> </span><a href="#local-6989586621679077080"><span class="hs-identifier hs-var">s</span></a><span class="hs-special">)</span><span>
</span><a name="line-27"></a><span>  </span><span class="hs-special">,</span><span class="hs-identifier">functions</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Map</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">insert</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">output</span><span> </span><a href="#local-6989586621679077081"><span class="hs-identifier hs-var">rel</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">rule</span><span> </span><a href="#local-6989586621679077081"><span class="hs-identifier hs-var">rel</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">functions</span><span> </span><a href="#local-6989586621679077080"><span class="hs-identifier hs-var">s</span></a><span class="hs-special">)</span><span>
</span><a name="line-28"></a><span>  </span><span class="hs-special">,</span><span class="hs-identifier">order</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Map</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">union</span><span>
</span><a name="line-29"></a><span>    </span><span class="hs-special">(</span><span class="hs-identifier hs-var">foldr</span><span>
</span><a name="line-30"></a><span>      </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Map</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">alter</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-glyph">\</span><a name="local-6989586621679078131"><a href="#local-6989586621679078131"><span class="hs-identifier">val</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">if</span><span> </span><a href="#local-6989586621679078131"><span class="hs-identifier hs-var">val</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><span class="hs-identifier hs-var">Nothing</span><span> </span><span class="hs-keyword">then</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-special">[</span><span class="hs-identifier">output</span><span> </span><a href="#local-6989586621679077081"><span class="hs-identifier hs-var">rel</span></a><span class="hs-special">]</span><span> </span><span class="hs-keyword">else</span><span> </span><span class="hs-identifier hs-var">Just</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">output</span><span> </span><a href="#local-6989586621679077081"><span class="hs-identifier hs-var">rel</span></a><span class="hs-special">)</span><span class="hs-glyph">:</span><span class="hs-special">(</span><span class="hs-identifier hs-var">Maybe</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">fromJust</span><span> </span><a href="#local-6989586621679078131"><span class="hs-identifier hs-var">val</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">)</span><span>
</span><a name="line-31"></a><span>      </span><span class="hs-special">(</span><span class="hs-identifier">order</span><span> </span><a href="#local-6989586621679077080"><span class="hs-identifier hs-var">s</span></a><span class="hs-special">)</span><span>
</span><a name="line-32"></a><span>      </span><span class="hs-special">(</span><span class="hs-identifier">input</span><span> </span><a href="#local-6989586621679077081"><span class="hs-identifier hs-var">rel</span></a><span class="hs-special">)</span><span>
</span><a name="line-33"></a><span>      </span><span class="hs-special">)</span><span>
</span><a name="line-34"></a><span>    </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Map</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">singleton</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">output</span><span> </span><a href="#local-6989586621679077081"><span class="hs-identifier hs-var">rel</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span>
</span><a name="line-35"></a><span>  </span><span class="hs-special">,</span><span class="hs-identifier">values</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">length</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">rule</span><span> </span><a href="#local-6989586621679077081"><span class="hs-identifier hs-var">rel</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">==</span><span> </span><span class="hs-number">1</span><span> </span><span class="hs-keyword">then</span><span> </span><span class="hs-special">(</span><a href="DataDefinitions.html#Named_Value"><span class="hs-identifier hs-var">Named_Value</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">output</span><span> </span><a href="#local-6989586621679077081"><span class="hs-identifier hs-var">rel</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><a href="Interpreter.html#evaluateExpression"><span class="hs-identifier hs-var">evaluateExpression</span></a><span> </span><a href="#local-6989586621679077080"><span class="hs-identifier hs-var">s</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">rule</span><span> </span><a href="#local-6989586621679077081"><span class="hs-identifier hs-var">rel</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">)</span><span> </span><span class="hs-special">)</span><span class="hs-glyph">:</span><span class="hs-special">(</span><span class="hs-identifier">values</span><span> </span><a href="#local-6989586621679077080"><span class="hs-identifier hs-var">s</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">else</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">values</span><span> </span><a href="#local-6989586621679077080"><span class="hs-identifier hs-var">s</span></a><span class="hs-special">)</span><span>
</span><a name="line-36"></a><span>  </span><span class="hs-special">}</span><span>
</span><a name="line-37"></a><span class="hs-identifier">update</span><span> </span><a name="local-6989586621679078132"><a href="#local-6989586621679078132"><span class="hs-identifier">s</span></a></a><span> </span><span class="hs-special">(</span><a href="DataDefinitions.html#Start_Execution"><span class="hs-identifier hs-var">Start_Execution</span></a><span> </span><a name="local-6989586621679078133"><a href="#local-6989586621679078133"><span class="hs-identifier">app</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-38"></a><span>  </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679078134"><a href="#local-6989586621679078134"><span class="hs-identifier">startValues</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">map</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">uncurry</span><span> </span><a href="DataDefinitions.html#Named_Value"><span class="hs-identifier hs-var">Named_Value</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">map</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><a name="local-6989586621679078150"><a href="#local-6989586621679078150"><span class="hs-identifier">input</span></a></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">inputname</span><span> </span><a href="#local-6989586621679078150"><span class="hs-identifier hs-var">input</span></a><span class="hs-special">,</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">read</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">origin</span><span> </span><a href="#local-6989586621679078150"><span class="hs-identifier hs-var">input</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">::</span><span class="hs-identifier hs-type">Double</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">appinput</span><span> </span><a href="#local-6989586621679078133"><span class="hs-identifier hs-var">app</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">in</span><span>
</span><a name="line-39"></a><span>    </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679078180"><a href="#local-6989586621679078180"><span class="hs-identifier">availableVars</span></a></a><span> </span><span class="hs-glyph">=</span><span>  </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Set</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">union</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">available</span><span> </span><a href="#local-6989586621679078132"><span class="hs-identifier hs-var">s</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">Set</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">fromList</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">map</span><span> </span><span class="hs-identifier">inputname</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier">appinput</span><span> </span><a href="#local-6989586621679078133"><span class="hs-identifier hs-var">app</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">in</span><span>
</span><a name="line-40"></a><span>      </span><span class="hs-keyword">let</span><span>  </span><a name="local-6989586621679078181"><a href="#local-6989586621679078181"><span class="hs-identifier">missingVars</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Set</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">difference</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">missing</span><span> </span><a href="#local-6989586621679078132"><span class="hs-identifier hs-var">s</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679078180"><span class="hs-identifier hs-var">availableVars</span></a><span>
</span><a name="line-41"></a><span>        </span><span class="hs-keyword">in</span><span>
</span><a name="line-42"></a><span>          </span><span class="hs-identifier hs-var">foldr</span><span> </span><a href="Interpreter.html#update%27"><span class="hs-identifier hs-var">update'</span></a><span> </span><a href="#local-6989586621679078132"><span class="hs-identifier hs-var">s</span></a><span class="hs-special">{</span><span>
</span><a name="line-43"></a><span>          </span><span class="hs-identifier">available</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679078180"><span class="hs-identifier hs-var">availableVars</span></a><span>
</span><a name="line-44"></a><span>          </span><span class="hs-special">,</span><span class="hs-identifier">missing</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679078181"><span class="hs-identifier hs-var">missingVars</span></a><span>
</span><a name="line-45"></a><span>          </span><span class="hs-special">,</span><span class="hs-identifier">functions</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">foldl</span><span> </span><a href="Interpreter.html#insert%27"><span class="hs-identifier hs-var">insert'</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">functions</span><span> </span><a href="#local-6989586621679078132"><span class="hs-identifier hs-var">s</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">appinput</span><span> </span><a href="#local-6989586621679078133"><span class="hs-identifier hs-var">app</span></a><span class="hs-special">)</span><span>
</span><a name="line-46"></a><span>          </span><span class="hs-special">,</span><span class="hs-identifier">values</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679078134"><span class="hs-identifier hs-var">startValues</span></a><span> </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">values</span><span> </span><a href="#local-6989586621679078132"><span class="hs-identifier hs-var">s</span></a><span class="hs-special">)</span><span>
</span><a name="line-47"></a><span>          </span><span class="hs-special">}</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">map</span><span> </span><a href="DataDefinitions.html#Trigger_Event"><span class="hs-identifier hs-var">Trigger_Event</span></a><span> </span><a href="#local-6989586621679078134"><span class="hs-identifier hs-var">startValues</span></a><span class="hs-special">)</span><span>
</span><a name="line-48"></a><span class="hs-identifier">update</span><span> </span><a name="local-6989586621679078182"><a href="#local-6989586621679078182"><span class="hs-identifier">s</span></a></a><span> </span><span class="hs-special">(</span><a href="DataDefinitions.html#Trigger_Event"><span class="hs-identifier hs-var">Trigger_Event</span></a><span> </span><a name="local-6989586621679078183"><a href="#local-6989586621679078183"><span class="hs-identifier">namedVal</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-49"></a><span>  </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679078184"><a href="#local-6989586621679078184"><span class="hs-identifier">newState</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Interpreter.html#changeValue"><span class="hs-identifier hs-var">changeValue</span></a><span> </span><a href="#local-6989586621679078182"><span class="hs-identifier hs-var">s</span></a><span> </span><a href="#local-6989586621679078183"><span class="hs-identifier hs-var">namedVal</span></a><span> </span><span class="hs-keyword">in</span><span>
</span><a name="line-50"></a><span>    </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679078185"><a href="#local-6989586621679078185"><span class="hs-identifier">triggerEventList</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-special">{</span><span>
</span><a name="line-51"></a><span>      </span><a name="local-6989586621679078186"><a href="#local-6989586621679078186"><span class="hs-identifier">lookedUp</span></a></a><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-special">(</span><span> </span><span class="hs-identifier hs-var">Map</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">lookup</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">name</span><span> </span><a href="#local-6989586621679078183"><span class="hs-identifier hs-var">namedVal</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">order</span><span> </span><a href="#local-6989586621679078184"><span class="hs-identifier hs-var">newState</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">)</span><span>
</span><a name="line-52"></a><span>      </span><span class="hs-special">;</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">map</span><span>  </span><a href="DataDefinitions.html#Trigger_Event"><span class="hs-identifier hs-var">Trigger_Event</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">map</span><span> </span><span class="hs-special">(</span><a href="Interpreter.html#reCalculateValue"><span class="hs-identifier hs-var">reCalculateValue</span></a><span> </span><a href="#local-6989586621679078184"><span class="hs-identifier hs-var">newState</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679078186"><span class="hs-identifier hs-var">lookedUp</span></a><span>
</span><a name="line-53"></a><span>      </span><span class="hs-special">}</span><span> </span><span class="hs-keyword">in</span><span>
</span><a name="line-54"></a><span>      </span><span class="hs-keyword">if</span><span> </span><a href="#local-6989586621679078185"><span class="hs-identifier hs-var">triggerEventList</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><span class="hs-identifier hs-var">Nothing</span><span> </span><span class="hs-keyword">then</span><span> </span><a href="#local-6989586621679078182"><span class="hs-identifier hs-var">s</span></a><span class="hs-special">{</span><span class="hs-identifier">errors</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-string">&quot;Error finding following Variables for: &quot;</span><span> </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">name</span><span> </span><a href="#local-6989586621679078183"><span class="hs-identifier hs-var">namedVal</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-string">&quot; in &quot;</span><span> </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">show</span><span> </span><a href="#local-6989586621679078184"><span class="hs-identifier hs-var">newState</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-glyph">:</span><span class="hs-special">(</span><span class="hs-identifier">errors</span><span> </span><a href="#local-6989586621679078184"><span class="hs-identifier hs-var">newState</span></a><span class="hs-special">)</span><span class="hs-special">}</span><span>
</span><a name="line-55"></a><span>        </span><span class="hs-keyword">else</span><span> </span><span class="hs-identifier hs-var">foldl</span><span> </span><a href="Interpreter.html#update"><span class="hs-identifier hs-var">update</span></a><span> </span><a href="#local-6989586621679078184"><span class="hs-identifier hs-var">newState</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">Maybe</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">fromJust</span><span> </span><a href="#local-6989586621679078185"><span class="hs-identifier hs-var">triggerEventList</span></a><span class="hs-special">)</span><span>
</span><a name="line-56"></a><span>
</span><a name="line-57"></a><span class="hs-comment">-- | wird f&#252;r das folding der Application_Inputs verwendet</span><span>
</span><a name="line-58"></a><span class="hs-identifier">insert'</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">Map</span><span> </span><span class="hs-identifier hs-type">String</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">String</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="YMLReader.html#Application_Input"><span class="hs-identifier hs-type">Application_Input</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Map</span><span> </span><span class="hs-identifier hs-type">String</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">String</span><span class="hs-special">]</span><span>
</span><a name="line-59"></a><a name="insert%27"><a href="Interpreter.html#insert%27"><span class="hs-identifier">insert'</span></a></a><span> </span><a name="local-6989586621679078187"><a href="#local-6989586621679078187"><span class="hs-identifier">ma</span></a></a><span> </span><span class="hs-special">(</span><a href="YMLReader.html#Application_Input"><span class="hs-identifier hs-var">Application_Input</span></a><span> </span><a name="local-6989586621679078188"><a href="#local-6989586621679078188"><span class="hs-identifier">name</span></a></a><span> </span><a name="local-6989586621679078189"><a href="#local-6989586621679078189"><span class="hs-identifier">val</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">Map</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">insert</span><span> </span><a href="#local-6989586621679078188"><span class="hs-identifier hs-var">name</span></a><span> </span><span class="hs-special">[</span><a href="#local-6989586621679078189"><span class="hs-identifier hs-var">val</span></a><span class="hs-special">]</span><span> </span><a href="#local-6989586621679078187"><span class="hs-identifier hs-var">ma</span></a><span>
</span><a name="line-60"></a><span class="hs-comment">-- | update' ist update mit verdrehter signatur, f&#252;r details siehe 'update'</span><span>
</span><a name="line-61"></a><span class="hs-identifier">update'</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="DataDefinitions.html#Event"><span class="hs-identifier hs-type">Event</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="DataDefinitions.html#State"><span class="hs-identifier hs-type">State</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="DataDefinitions.html#State"><span class="hs-identifier hs-type">State</span></a><span>
</span><a name="line-62"></a><a name="update%27"><a href="Interpreter.html#update%27"><span class="hs-identifier">update'</span></a></a><span> </span><a name="local-6989586621679078190"><a href="#local-6989586621679078190"><span class="hs-identifier">e</span></a></a><span> </span><a name="local-6989586621679078191"><a href="#local-6989586621679078191"><span class="hs-identifier">s</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="Interpreter.html#update"><span class="hs-identifier hs-var">update</span></a><span> </span><a href="#local-6989586621679078191"><span class="hs-identifier hs-var">s</span></a><span> </span><a href="#local-6989586621679078190"><span class="hs-identifier hs-var">e</span></a><span>
</span><a name="line-63"></a><span class="hs-comment">-- | interpretiert die rules einer Relation. f&#252;r mehr Regeln hier erg&#228;nzen !</span><span>
</span><a name="line-64"></a><span class="hs-identifier">evaluateExpression</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="DataDefinitions.html#State"><span class="hs-identifier hs-type">State</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-identifier hs-type">String</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Double</span><span>
</span><a name="line-65"></a><a name="evaluateExpression"><a href="Interpreter.html#evaluateExpression"><span class="hs-identifier">evaluateExpression</span></a></a><span> </span><a name="local-6989586621679078192"><a href="#local-6989586621679078192"><span class="hs-identifier">s</span></a></a><span> </span><span class="hs-special">[</span><a name="local-6989586621679078193"><a href="#local-6989586621679078193"><span class="hs-identifier">a</span></a></a><span class="hs-special">,</span><span class="hs-string">&quot;div&quot;</span><span class="hs-special">,</span><a name="local-6989586621679078194"><a href="#local-6989586621679078194"><span class="hs-identifier">b</span></a></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><a href="Interpreter.html#retrieveValue"><span class="hs-identifier hs-var">retrieveValue</span></a><span> </span><a href="#local-6989586621679078192"><span class="hs-identifier hs-var">s</span></a><span> </span><a href="#local-6989586621679078193"><span class="hs-identifier hs-var">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">/</span><span> </span><span class="hs-special">(</span><a href="Interpreter.html#retrieveValue"><span class="hs-identifier hs-var">retrieveValue</span></a><span> </span><a href="#local-6989586621679078192"><span class="hs-identifier hs-var">s</span></a><span> </span><a href="#local-6989586621679078194"><span class="hs-identifier hs-var">b</span></a><span class="hs-special">)</span><span>
</span><a name="line-66"></a><span class="hs-identifier">evaluateExpression</span><span> </span><a name="local-6989586621679078688"><a href="#local-6989586621679078688"><span class="hs-identifier">s</span></a></a><span> </span><span class="hs-special">[</span><a name="local-6989586621679078689"><a href="#local-6989586621679078689"><span class="hs-identifier">a</span></a></a><span class="hs-special">,</span><span class="hs-string">&quot;mul&quot;</span><span class="hs-special">,</span><a name="local-6989586621679078690"><a href="#local-6989586621679078690"><span class="hs-identifier">b</span></a></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><a href="Interpreter.html#retrieveValue"><span class="hs-identifier hs-var">retrieveValue</span></a><span> </span><a href="#local-6989586621679078688"><span class="hs-identifier hs-var">s</span></a><span> </span><a href="#local-6989586621679078689"><span class="hs-identifier hs-var">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">*</span><span> </span><span class="hs-special">(</span><a href="Interpreter.html#retrieveValue"><span class="hs-identifier hs-var">retrieveValue</span></a><span> </span><a href="#local-6989586621679078688"><span class="hs-identifier hs-var">s</span></a><span> </span><a href="#local-6989586621679078690"><span class="hs-identifier hs-var">b</span></a><span class="hs-special">)</span><span>
</span><a name="line-67"></a><span class="hs-identifier">evaluateExpression</span><span> </span><a name="local-6989586621679078764"><a href="#local-6989586621679078764"><span class="hs-identifier">s</span></a></a><span> </span><span class="hs-special">[</span><a name="local-6989586621679078765"><a href="#local-6989586621679078765"><span class="hs-identifier">a</span></a></a><span class="hs-special">,</span><span class="hs-string">&quot;add&quot;</span><span class="hs-special">,</span><a name="local-6989586621679078766"><a href="#local-6989586621679078766"><span class="hs-identifier">b</span></a></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><a href="Interpreter.html#retrieveValue"><span class="hs-identifier hs-var">retrieveValue</span></a><span> </span><a href="#local-6989586621679078764"><span class="hs-identifier hs-var">s</span></a><span> </span><a href="#local-6989586621679078765"><span class="hs-identifier hs-var">a</span></a><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">+</span><span> </span><span class="hs-special">(</span><a href="Interpreter.html#retrieveValue"><span class="hs-identifier hs-var">retrieveValue</span></a><span> </span><a href="#local-6989586621679078764"><span class="hs-identifier hs-var">s</span></a><span> </span><a href="#local-6989586621679078766"><span class="hs-identifier hs-var">b</span></a><span class="hs-special">)</span><span>
</span><a name="line-68"></a><span class="hs-identifier">evaluateExpression</span><span> </span><a name="local-6989586621679078767"><a href="#local-6989586621679078767"><span class="hs-identifier">s</span></a></a><span> </span><span class="hs-special">[</span><a name="local-6989586621679078768"><a href="#local-6989586621679078768"><span class="hs-identifier">a</span></a></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-identifier hs-var">read</span><span> </span><a href="#local-6989586621679078768"><span class="hs-identifier hs-var">a</span></a><span>
</span><a name="line-69"></a><span>
</span><a name="line-70"></a><span class="hs-comment">-- | Extrahiert den aktuellen Wert einer Variable aus dem State. liefert -1234 falls es nicht gefunden wird</span><span>
</span><a name="line-71"></a><span class="hs-identifier">retrieveValue</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="DataDefinitions.html#State"><span class="hs-identifier hs-type">State</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">String</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Double</span><span>
</span><a name="line-72"></a><a name="retrieveValue"><a href="Interpreter.html#retrieveValue"><span class="hs-identifier">retrieveValue</span></a></a><span> </span><a name="local-6989586621679078769"><a href="#local-6989586621679078769"><span class="hs-identifier">s</span></a></a><span> </span><a name="local-6989586621679078770"><a href="#local-6989586621679078770"><span class="hs-identifier">valueName</span></a></a><span> </span><span class="hs-glyph">=</span><span>
</span><a name="line-73"></a><span>  </span><span class="hs-keyword">let</span><span> </span><a name="local-6989586621679078771"><a href="#local-6989586621679078771"><span class="hs-identifier">resultList</span></a></a><span> </span><span class="hs-glyph">=</span><span>  </span><span class="hs-identifier hs-var">filter</span><span> </span><span class="hs-special">(</span><a href="Interpreter.html#named"><span class="hs-identifier hs-var">named</span></a><span> </span><a href="#local-6989586621679078770"><span class="hs-identifier hs-var">valueName</span></a><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">values</span><span> </span><a href="#local-6989586621679078769"><span class="hs-identifier hs-var">s</span></a><span class="hs-special">)</span><span> </span><span class="hs-keyword">in</span><span>
</span><a name="line-74"></a><span>    </span><span class="hs-keyword">if</span><span> </span><span class="hs-identifier hs-var">null</span><span> </span><a href="#local-6989586621679078771"><span class="hs-identifier hs-var">resultList</span></a><span> </span><span class="hs-keyword">then</span><span> </span><span class="hs-glyph">-</span><span class="hs-number">1234</span><span> </span><span class="hs-keyword">else</span><span> </span><span class="hs-identifier">value</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">head</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="#local-6989586621679078771"><span class="hs-identifier hs-var">resultList</span></a><span>
</span><a name="line-75"></a><span>
</span><a name="line-76"></a><span>
</span><a name="line-77"></a><span class="hs-identifier">reCalculateValue</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="DataDefinitions.html#State"><span class="hs-identifier hs-type">State</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">String</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="DataDefinitions.html#Named_Value"><span class="hs-identifier hs-type">Named_Value</span></a><span>
</span><a name="line-78"></a><a name="reCalculateValue"><a href="Interpreter.html#reCalculateValue"><span class="hs-identifier">reCalculateValue</span></a></a><span> </span><a name="local-6989586621679078930"><a href="#local-6989586621679078930"><span class="hs-identifier">s</span></a></a><span> </span><a name="local-6989586621679078931"><a href="#local-6989586621679078931"><span class="hs-identifier">recalculated</span></a></a><span> </span><span class="hs-glyph">=</span><span> </span><a href="DataDefinitions.html#Named_Value"><span class="hs-identifier hs-var">Named_Value</span></a><span> </span><a href="#local-6989586621679078931"><span class="hs-identifier hs-var">recalculated</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><a href="Interpreter.html#evaluateExpression"><span class="hs-identifier hs-var">evaluateExpression</span></a><span> </span><a href="#local-6989586621679078930"><span class="hs-identifier hs-var">s</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">Maybe</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">fromJust</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">Map</span><span class="hs-operator hs-var">.</span><span class="hs-identifier hs-var">lookup</span><span> </span><a href="#local-6989586621679078931"><span class="hs-identifier hs-var">recalculated</span></a><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier">functions</span><span> </span><a href="#local-6989586621679078930"><span class="hs-identifier hs-var">s</span></a><span>
</span><a name="line-79"></a><span>
</span><a name="line-80"></a><span class="hs-identifier">changeValue</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="DataDefinitions.html#State"><span class="hs-identifier hs-type">State</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="DataDefinitions.html#Named_Value"><span class="hs-identifier hs-type">Named_Value</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="DataDefinitions.html#State"><span class="hs-identifier hs-type">State</span></a><span>
</span><a name="line-81"></a><a name="changeValue"><a href="Interpreter.html#changeValue"><span class="hs-identifier">changeValue</span></a></a><span> </span><a name="local-6989586621679078932"><a href="#local-6989586621679078932"><span class="hs-identifier">s</span></a></a><span> </span><a name="local-6989586621679078933"><a href="#local-6989586621679078933"><span class="hs-identifier">namedVal</span></a></a><span> </span><span class="hs-glyph">=</span><span>  </span><a href="#local-6989586621679078932"><span class="hs-identifier hs-var">s</span></a><span> </span><span class="hs-special">{</span><span class="hs-identifier">values</span><span> </span><span class="hs-glyph">=</span><span> </span><a href="#local-6989586621679078933"><span class="hs-identifier hs-var">namedVal</span></a><span class="hs-glyph">:</span><span class="hs-special">(</span><span class="hs-identifier hs-var">filter</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">not</span><span> </span><span class="hs-operator hs-var">.</span><span> </span><a href="Interpreter.html#named"><span class="hs-identifier hs-var">named</span></a><span> </span><span class="hs-special">(</span><span class="hs-identifier">name</span><span> </span><a href="#local-6989586621679078933"><span class="hs-identifier hs-var">namedVal</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="hs-identifier">values</span><span> </span><a href="#local-6989586621679078932"><span class="hs-identifier hs-var">s</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">}</span><span>
</span><a name="line-82"></a><span>
</span><a name="line-83"></a><span class="hs-identifier">named</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-identifier hs-type">String</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><a href="DataDefinitions.html#Named_Value"><span class="hs-identifier hs-type">Named_Value</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">Bool</span><span>
</span><a name="line-84"></a><a name="named"><a href="Interpreter.html#named"><span class="hs-identifier">named</span></a></a><span> </span><a name="local-6989586621679078934"><a href="#local-6989586621679078934"><span class="hs-identifier">key</span></a></a><span> </span><span class="hs-special">(</span><a href="DataDefinitions.html#Named_Value"><span class="hs-identifier hs-var">Named_Value</span></a><span> </span><a name="local-6989586621679078935"><a href="#local-6989586621679078935"><span class="hs-identifier">name</span></a></a><span> </span><span class="hs-identifier">_</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679078935"><span class="hs-identifier hs-var">name</span></a><span> </span><span class="hs-operator hs-var">==</span><span> </span><a href="#local-6989586621679078934"><span class="hs-identifier hs-var">key</span></a><span class="hs-special">)</span><span>
</span><a name="line-85"></a><span>
</span><a name="line-86"></a><span class="hs-comment">-- | process ruft mit den &#252;bergebenen Parametern der Reihe nach update auf.</span><span>
</span><a name="line-87"></a><span class="hs-comment">-- zus&#228;tzlich kann es noch das Event 'Read_Output' verarbeiten, welches IO Aktionen erfordert</span><span>
</span><a name="line-88"></a><span class="hs-identifier">process</span><span> </span><span class="hs-glyph">::</span><span> </span><a href="DataDefinitions.html#State"><span class="hs-identifier hs-type">State</span></a><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><a href="DataDefinitions.html#Event"><span class="hs-identifier hs-type">Event</span></a><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-identifier hs-type">IO</span><span> </span><a href="DataDefinitions.html#State"><span class="hs-identifier hs-type">State</span></a><span>
</span><a name="line-89"></a><a name="process"><a href="Interpreter.html#process"><span class="hs-identifier">process</span></a></a><span> </span><a name="local-6989586621679078936"><a href="#local-6989586621679078936"><span class="hs-identifier">s</span></a></a><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><a href="DataDefinitions.html#Read_Output"><span class="hs-identifier hs-var">Read_Output</span></a><span> </span><a name="local-6989586621679078937"><a href="#local-6989586621679078937"><span class="hs-identifier">app</span></a></a><span class="hs-special">)</span><span class="hs-glyph">:</span><a name="local-6989586621679078938"><a href="#local-6989586621679078938"><span class="hs-identifier">remaining</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-90"></a><span>   </span><span class="hs-identifier hs-var">putStrLn</span><span> </span><span class="hs-special">(</span><span class="hs-string">&quot;output is: &quot;</span><span> </span><span class="hs-operator hs-var">++</span><span> </span><span class="hs-special">(</span><span class="hs-identifier hs-var">show</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">map</span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><a name="local-6989586621679079109"><a href="#local-6989586621679079109"><span class="hs-identifier">a</span></a></a><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><a href="#local-6989586621679079109"><span class="hs-identifier hs-var">a</span></a><span class="hs-special">,</span><a href="Interpreter.html#retrieveValue"><span class="hs-identifier hs-var">retrieveValue</span></a><span> </span><a href="#local-6989586621679078936"><span class="hs-identifier hs-var">s</span></a><span> </span><a href="#local-6989586621679079109"><span class="hs-identifier hs-var">a</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier hs-var">map</span><span> </span><span class="hs-identifier">outputname</span><span> </span><span class="hs-operator hs-var">$</span><span> </span><span class="hs-identifier">appoutput</span><span> </span><a href="#local-6989586621679078937"><span class="hs-identifier hs-var">app</span></a><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><a name="line-91"></a><span>   </span><a href="Interpreter.html#process"><span class="hs-identifier hs-var">process</span></a><span> </span><a href="#local-6989586621679078936"><span class="hs-identifier hs-var">s</span></a><span> </span><a href="#local-6989586621679078938"><span class="hs-identifier hs-var">remaining</span></a><span>
</span><a name="line-92"></a><span class="hs-identifier">process</span><span> </span><a name="local-6989586621679079110"><a href="#local-6989586621679079110"><span class="hs-identifier">s</span></a></a><span> </span><span class="hs-special">(</span><a name="local-6989586621679079111"><a href="#local-6989586621679079111"><span class="hs-identifier">first</span></a></a><span class="hs-glyph">:</span><a name="local-6989586621679079112"><a href="#local-6989586621679079112"><span class="hs-identifier">remaining</span></a></a><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><a name="line-93"></a><span>  </span><a href="Interpreter.html#process"><span class="hs-identifier hs-var">process</span></a><span> </span><span class="hs-special">(</span><a href="Interpreter.html#update"><span class="hs-identifier hs-var">update</span></a><span> </span><a href="#local-6989586621679079110"><span class="hs-identifier hs-var">s</span></a><span> </span><a href="#local-6989586621679079111"><span class="hs-identifier hs-var">first</span></a><span class="hs-special">)</span><span> </span><a href="#local-6989586621679079112"><span class="hs-identifier hs-var">remaining</span></a><span>
</span><a name="line-94"></a><span class="hs-identifier">process</span><span> </span><a name="local-6989586621679079113"><a href="#local-6989586621679079113"><span class="hs-identifier">s</span></a></a><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-identifier hs-var">return</span><span> </span><a href="#local-6989586621679079113"><span class="hs-identifier hs-var">s</span></a><span>
</span><a name="line-95"></a></pre></body></html>